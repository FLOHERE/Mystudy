# Chapter2. 관계  데이터 모델
- 학습 목표
	- 관계 데이터 모델
		- 관계 데이터 모델의 개념을 이해
		- 무결성 제약조건에 대해 이해 
			- 데이터 무결성, 도메인 무결성, 개체 무결성 , 참조 무결성
		- 관계 대수에 대해 이해 
			- 관계대수 연산자, 관계대수식

## 01. 관계 데이터 모델의 개념
- 릴레이션
- 릴레이션 스키마와 인스턴스
- 릴레이션의 특징
- 관계 데이터 모델 

### 01-1) 릴레이션의 개념
- 릴레이션(relation)
	- 행과 열로 구성된 테이블
- 용어
	- relation : 테이블(관계 아님, 테이블이라고 읽어라)
	- realational data model : 관계 데이터 모델
	- realtional database : 관게 데이터 베이스
	- relational algebra : 관계 대수
	- realtionship : 관계
- 릴레이션이란?
	- 첫번째 행: 네개의 집합중 각각 한개의 원소를 선택해서 만든것.
	- 이 원소들이 relationship을 맺음
![[Pasted image 20240407221521.png]]

- 관계(relation)
	- 릴레이션 내에서 생성되는 관계
		- 릴레이션 내 데이터들의 관계
	- 릴레이션 간에 생성되는 관계
		- 릴레이션 간의 관계
![[Pasted image 20240407224037.png]]

### 01-2) 릴레이션 [[스키마]]와 인스턴스
- 릴레이션에 사용되는 용어를 학습
	- 속성,투플, 스키마, 인스턴스
![[Pasted image 20240407224436.png]]

- 릴레이션 스키마(=내포)
	- 속성(attribute)
		- 릴레이션  스키마의 열
	- 도메인(domain)(????)
		- 속성이 가질수 있는 값의 집합
	- 차수(degree)
		- 속성의 개수

- 스키마의 표현
```SQL
릴레이션 이름(속성1 : 도메인1, 속성2: 도메인 2, ...)
		- 예) 도서(도서번호, 도서이름, 출판사, 가격)
		- 도서)(도서번호 : integer, 도서이름:char(40), 
					출판사 : char(40), 가격 : integer)
```

- 릴레이션(테이블) 인스턴스(=외연)
	- 투플(tuple)
		- 릴레이션의 행
	- 카디날리티(cardinality) or 카디널리티
		- 투플의 수

### 01-3) 릴레이션의 특징
- 속성은 단일값을 가진다.
	- 각 속성의 값은 도메인에 정의 된 값만 기잠
	- 단일값(= 원자값) : 두개이상의 값을 가지지 않는다.
- 속성은 서로 다른 이름을 가진다.
	- 속성은 한 릴레이션에서 서로 다른 이름을 가져야함
- 한 속성의 값은 모두 같은 도메인 값을 가짐
	- 한 속성에 속한 열은 모두 그 속성에서 정의한 도메인 값만 가짐
- 속성의 순서는 상관 없음
	- 속성의 순서가 달라도 리레이션 스키마 같음
	- ex_)(이름,주소) = (주소, 이름)
- 릴레이션 내의 중복된 투플은 허용하지 않음
	- 하나의 릴레이션 인스턴스 내에 서로 중복된 값 못가짐
	- 모든 투플은 서로 값이 달라야함
- 투플의 순서는 상관 없음

- 릴레이션의 특정에 위배되는 경우
	- 속성은 단일 값, 중복된 투플은 허용 X

![[Pasted image 20240407231405.png]]

### 01-4) 관계 데이터 모델
- 관계 데이터 모델은 데이터를 2D 테이블 형태인 릴레이션으로 표현
	- 릴레이션에 대한 제약조건과 관계 연산을 위한 관계대수를 정의함

## 02. 무결성 제약조건
- 키
- 무결성 제약조건
- 무결성 제약조건의 수행

### 02-1) 키(Key)
- 키 : 특정 투플을 식별할때 사용하는 속성(속성의 집합)
- 릴레이션 = 중복된 투플 지원 X
	- 각각의 투플에 포함된 속성중 하나이상은 값이 다름.
	- 값이 다른 속성 = 키로 설정
		- 값이 달라서 구별에 쓰이는거임
- 키는 릴레이션간의 관계를 맺는데도 사용
	- 키 = 중복되는 투플 방지

### 02-2) 슈퍼키(Super Key)
- 투플을 유일하게 식별할수 있는 하나의 속성(속성의 집합)
	- 투플을 유일하게 식별할수 있는 값 = 모두 슈퍼키
	- ex_)
		- 고객번호 : 유일값O = 수펴키O
		- 이름 : 동명이인이 있을수도? = 슈퍼키X
		- 주민번호 : 유일값 O = 슈퍼키O
		- 주소 : 가족끼리 같은 집에 살수도.. = 수퍼키X
		- 핸드폰 : 한사람이 여러대의 핸드폰 사용 or 핸드폰이 없을 수도 ? = 슈퍼키X

### 02-3) 후보키(Candidate Key)
- 투플을 유일하게 식별 할수 있는 속성의 최소 집합
	- "유일하게 식별" = "유일성"을 가진다.
	- "최소집합" = "최소성"을 가진다.
- ex_)
![[Pasted image 20240409154657.png]]
- 주문 릴레이션의 후보키 : 고객번호 + 도서번호 (2개의 속성을 합쳐 사용)
	- 고객이 같은 도서를 한번만 구입할수 있다고 가정
- 복합키(composite key)
	- 2개 이상의 속성으로 이루어진 키

### 02-4) 기본키(Primary Key)
- 여러 후보키 중 하나를 선정, 대표로 삼는 키
- 후보키가 하나뿐이라면 그 후보키를 기본키로 사용
- 후보키가 여러개 = 릴레이션의 특성을 반영, 하나 선택

- 기본키 선정시 고려사항
	- 고유한 값을 가져야 함
	- NULL 값은 허용 X
	- 키 값의 변동이 일어나지 않아야 함
	- 최대한 적은 수의 속성을가진 것이어야 함
	- 문제 소지 X 여야함
- 렐리이션 스키마를 표현  (기본키는 이텔릭 표시)
	- 릴레이션 이름(*속성1*, 속성2..속성N)
	- 고객(*고객번호*, 이름,주민번호, 주소, 핸드폰)
	- 도서(*도서번호*, 도서이름, 출판사, 가격)

### 02-5) 대리키(Surrogate Key)
- 일련번호 같은 가상의 속성을 만들어 기본키로 설정
	- 기본키가 보안을 요한 경우
	- 여러개의 속성으로 구성되어 복잡한 경우
	- 마땅한 기본키가 없는 경우
- 대리키(surrogate key) = 인조키(artificial key)
- 대리키는 DBMS나 관련 소프트웨어에서 임의로 생성하는 값으로 사용자가 직관적으로 그 값의 의미를 모름

- 기존의 주문 릴레이션 = 복합키 사용 = 복잡하다!
	- "주문번호" 라는 새로운 속성을 생성
	- 한명의 고객이 같은도서를 구입할수 있게 해줌
![[Pasted image 20240409160813.png]]

### 02-6) 대체키(Alternate key)
- 기본키로 선정되지 않은 후보키

### 02-7) 외래키(Foreign Key) - 시발 이게 뭔 개소리야 씨발
- 다른 릴레이션의 기본키를 참조하는 속성
	- 릴레이션간의 관계(relationship) 를 표현
![[Pasted image 20240409161752.png]]

- 외래키의 특징
	- 관계 데이터 모델의 릴레이션 간의 관계를 표현
	- 다른 릴레이션의 기본키 참조
	- 참조하고(외래키) 참조되는(기본키)의 양쪽 릴레이션의 도메인?은 서로 같아야 한다.
	- 참조되는(기본키) 값이 변경되면 참조하는(외래키) 값도 변경됨
		- ==참조 무결성 제약조건(외래키 제약조건): 없는 값을 참조하게 될 경우의 대안 방안==
	- Null 값과 중복 값 등 허용 : 다른 릴레이션의 값이라 상관 없음
	- 자기 자신의 기본키를 참조하는 외래키도 가능
	- 외래키가 기본키의 일부가 될수 있음

- 외래키 사용시 특이사항
	- 참조하는(or 되는) 릴레이션 = 같은 릴레이션 일수도...?
		- 자기 자신의 기본키 참조 가능
![[Pasted image 20240409164558.png]]

### 02-8) 키의 포함 관계
- 살펴본 키의 종류
	- 슈퍼키, 후보키, 기본키, 대체키
	- 대리키(인조키), 외래키

### 02-9) 무결성 제약 조건
- 데이터 무결성(Integrity)
	- 데이터베이스에 저장된 데이터의 일관성과 정확성을 지키는 것
	- {도메인, 개체, 참조} 무결성 제약 조건
- 도메인 무결성 제약조건
	- = 도메인 제약(domain constraint)
	- 투플들이 각 속성의 도메인에 지정된 값만 가져야 한다는 조건
	- SQL 문에서 지정 가능한 옵션
		- 데이터 형식(Type)
		- 널(null/note null)
		- 기본 값(default)
		- 체크(check)
- 개체 무결성 제약조건
	- = 기본키 제약(primary key constraint)
	- 릴레이션간의 참조 관계를 선언하는 제약조건
		- 자식 릴레이션의 외래키는 부모 릴레이션의 기본키와 도메인이 동일 해야함
		- 자식 릴레이션의 값이 변경될때 부모릴레이션의 제약을 받는다는것.
			- 부모가 존재해야 참조 가능
![[Pasted image 20240409165842.png]]

- +) UNIQUE 제약조건
	- = 유일성 제약조건 or 고유성 제약조건(unique constraint)
	- 속성의 모든 값은 서로 같은 값이 "없어야" 한다
		- 이는 릴레이션 내의 각각의 투플을 유일하게 식별할수 있는 속성들의 집합
		- Null값 허용

### 02-10) 무결성 제약조건의 수행
- 릴레이션은 데이터의 변경이 일어날떄 제약조건에 위배될수 있음
	- 데이터의 변경이 있을때 마다 제약조건을 지키는지 확인
		- 삽입, 수정, 삭제
	- ex_)
		- 기존의 기본키 값을 다른 투플의 기본키 값으로 변경 -> 해당 연산은 거부됨
		- 부모 릴레이션에서 투플을 삭제할 경우 자식 릴레이션은? -> 부모 릴레이션과 자식 릴레이션의 관계가 있다면(참조하는 행이 있다면) 같이 삭제됨, 관계가 없으면 오류(제약조건 위반)
- 개체 무결성 제약조건
- 참조 무결성 제약조건

### 02-11) 개체 무결성 제약조건
- 삽입
	- 기본키 값이 같거나 null 이면 삽입 금지
- 수정
	- 기본키 값이 같거나 null 로도 수정 금지됨
- 삭제
	- 특별한 확인이 필요하지 않으며 즉시 수행
	- 예외) 기본키가 외래키로 사용된 경우
- ex_)
	- 밑의 예시를 보자!
		- 남슬찬씨를 새로 등록하고 싶다! -> 이런!! 박지성씨와 학번이 겹친다 ㅠㅠ -> 삽입 거부
		- 그럼 학번없이 추가 하자! -> 이런!! 개체 무결성 제약조건에 어긋난다 ㅠㅠ -> 삽입거부
![[Pasted image 20240409222726.png]]

- ex_2)
	- (601, 박세리, 3001) 를 삽입하고 싶다 -> 부모 릴레이션(학과코드)에 3001이라는 과목 코드는 없다 -> 삽입 거부
	- 학과 릴레이션에 (3001,수학과) 를 삽입한 후, 학생을 삽입하면 가능!
![[Pasted image 20240409223008.png]]

- 부모 릴레이션의 투플이 삭제 될 경우
	- 참조하는 테이블을 같이 삭제 할수 있어서 금지시키기
	- or 다른 추가 작업 필요
- 